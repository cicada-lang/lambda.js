use trail to implement equivalent for recursive functions
